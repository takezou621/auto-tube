# AutoTube プロダクト完成までの優先課題まとめ

## 現状サマリ
- フロントエンドは仮のQMSログイン画面のみで、AutoTube機能を反映していない。
- バックエンドはFastAPIのヘルスチェックとTTSラッパ（ElevenLabs向け）のみが存在し、動画生成フローのビジネスロジックが未実装。
- テストは利用中のTTSプロバイダ向けユニットテストとヘルスチェック疎通のみで、機能要件を検証する仕組みが不足。

## MVP完了に必要なユースケース
1. **動画プロジェクトの作成**
   - 入力: 物件概要（名称/場所/利回りなど）、ターゲット視聴者、動画尺（短/中/長）。
   - 出力: 起承転結構成のナレーションスクリプト、想定カットリストのポイント。
2. **音声合成**
   - 入力: 生成済みスクリプト、ボイスプリセット。
   - 出力: ElevenLabsによる音声バイナリ（APIキー未設定時はエラーハンドリング）。
3. **履歴の取得**
   - 過去に生成したプロジェクトのパラメータと出力を参照できる簡易履歴。
4. **UIフロー**
   - 単一ページでプロジェクト作成→スクリプト確認→音声生成→ダウンロードまで完結。

## 優先課題（Issue案）
- **Issue #1: スクリプト生成APIとフロントUI刷新（完了）**
  - バックエンドに `/api/projects` POST を実装し、テンプレート生成ロジックを提供。
  - フロントエンドをAutoTube仕様のフォーム＋結果表示画面に刷新。
  - FastAPIユニットテストとVitestベースのユーティリティテストを追加。
- **Issue #2: 音声合成API統合とUI連携（完了）**
  - `/api/projects/{id}/tts` を追加し、ElevenLabs/モックの双方で音声バイナリを返却。
  - フロントエンドに音声生成ボタン、再生・ダウンロード導線、エラーハンドリングを実装。
  - バックエンドAPIテストとVitestで成功/失敗/未設定パターンを検証。
- **Issue #3: プロジェクト履歴管理と永続化（完了）**
  - インメモリからJSON永続化層に切り替え、APIから履歴一覧を取得可能にした。
  - フロントに履歴一覧とワンクリック読み込み導線を追加し、生成結果を再利用できるようにした。
- **Issue #4: CI整備（完了）**
  - `pnpm lint && pnpm test` / `poetry run pytest` を統合したルートMakeコマンドを整備し、GitHub Actionsテンプレを作成。
- **Issue #5: ストーリーボード生成API（完了）**
  - シーンごとのB-roll案・テロップ案を返すテンプレートジェネレータとAPIを実装。
  - フロントにストーリーボード表示セクションを追加し、動画制作フェーズの指針を提供。
- Issue #6: PlanetScale/動画生成ワークフロー拡張
  - PlanetScale / Render Worker など本番想定インフラへの移行計画と、動画レンダリングパイプラインの検証実装を進める。

## 今後の進め方
- 次は Issue #6 で永続DB（PlanetScale等）や動画生成ワークフローの統合計画を具体化する。
- 併せて外部API連携（ストック映像検索など）や自動レンダリング基盤の検討を進める。
- 完了済みIssueの回帰を維持するため、テンプレリビュードキュメントとテスト結果をPRで更新し続ける。
- 各IssueはPRに Problem / Approach / Tests / Risk & Rollback を記載する。
